<link rel="import" href="../polymer/polymer.html" />
<link rel="import" href="../t-calendar/t-calendar.html">
<link rel="import" href="../t-input/t-input.html">
<link rel="import" href="../t-radio-group/t-radio-group.html">

<dom-module id="t-passenger-segment">
    <style>
        :host {
            width: 100%;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            overflow: hidden;
        }
        
        .vertical-margin {
            margin-bottom: 10px;
        }
        
        .vertical-margin t-input {
            margin-right: 5px;
        }
        
        .vertical-margin t-input:last-child {
            margin-right: 0;
        }
        
        .suffix {
            width: 20%;
        }
        
        .calendar {
            margin-right: 5px;
        }
        
        :host::content input {
            text-transform: capitalize;
        }
        
        .section {
            padding: 0 10px;
        }
        </style>
    <template>       
        <div class="section">
            <div class="vertical-margin layout horizontal center">
                <t-input id="firstName" class="flex" label="First"  error-message="You missed this." required auto-validate value="{{firstName}}"></t-input>
            </div>
            <template is="dom-if" if=[[!hideMiddleName]]>
                <div class="vertical-margin layout horizontal center">
                    <t-input id="middleName" class="flex" label="Middle" auto-validate value="{{middleName}}"></t-input>
                </div>
            </template>
            <div class="vertical-margin layout horizontal center">
                <t-input id="lastName" class="flex" label="Last" error-message="You missed this." required auto-validate value="{{lastName}}"></t-input>
                <template is="dom-if" if=[[!hideSuffix]]>
                    <t-input id="suffix" class="suffix" label="Suffix" error-message="You missed this." required auto-validate value="{{suffix}}"></t-input>
                </template>
            </div>
            <div class="vertical-margin layout horizontal center center-justified">
                <template is="dom-if" if=[[!hideDateOfBirth]]>
                    <t-calendar id="dateOfBirth" class="flex calendar" is-dob required label="Date of birth" min="{{_getMinDate(type)}}" max="{{_getMaxDate(type)}}" format="mm/dd/yyyy" submit-format="mm/dd/yyyy" selected-date="{{dateOfBirth}}" error-message="Enter date of birth"></t-calendar>
                </template>
                <template is="dom-if" if=[[!hideGender]]>
                    <t-radio-group id="gender" pill-button selected-item="{{gender}}" data='["Male","Female"]'></t-radio-group>
                </template>
            </div>
        </div>
    </template>
</dom-module>
<script>
(function() {
    Polymer({

        is: 't-passenger-segment',

        properties: {

            firstName: {
                type: 'String',
                notify: true
            },

            middleName: {
                type: 'String',
                notify: true
            },

            lastName: {
                type: 'String',
                notify: true
            },

            suffix: {
                type: 'String',
                notify: true
            },

            dateOfBirth: {
                type: 'String',
                notify: true
            },

            /*allowed types(case sensitive): Male/Female */
            gender: {
                type: String,
                value: 'Male',
                notify: true
            },

            /*allowed types(case sensitive): Adult/Child/Infant/Senior */
            type: {
                type: 'String',
                notify: true
            },

            hideMiddleName: {
                type: Boolean,
                value: false
            },

            hideSuffix: {
                type: Boolean,
                value: false
            },

            hideDateOfBirth: {
                type: Boolean,
                value: false
            },

            hideGender: {
                type: Boolean,
                value: false
            },


        },

        ready: function() {
            this._setCalendar();
        },

        attached: function(){
            this.hideMiddleName = !(!this.hideMiddleName);
            this.hideSuffix = !(!this.hideSuffix);
            this.hideDateOfBirth = !(!this.hideDateOfBirth);
            this.hideGender = !(!this.hideGender);
        },
        
        _setCalendar: function() {
            var calArr = Polymer.dom(this.root).querySelectorAll('t-calendar');
        },

        _getMinDate: function(type) {
            var date = new Date();
            switch (type.toLowerCase()) {
                case 'child':
                    return new Date(date.setFullYear(date.getFullYear() - 11));
                case 'infant':
                    return new Date(date.setFullYear(date.getFullYear() - 2));

            }
        },

        _getMaxDate: function(type) {
            return new Date();
        },

        validate: function() {
            var isValid = this.$.firstName.validate() ;
            isValid = this.$.lastName.validate() && isValid ;
            if(!this.hideDateOfBirth){
                isValid = this.$.dateOfBirth.validate() && isValid ;
            }
            return isValid;
        }
    });
})();
</script>
